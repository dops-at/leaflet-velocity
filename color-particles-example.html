<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Color Mapping Velocity Example - Integration Guide</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Velocity Plugin CSS -->
    <link rel="stylesheet" href="dist/leaflet-velocity.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .info-box {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .info-box h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .map-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            margin-bottom: 30px;
        }

        #map {
            height: 600px;
            width: 100%;
        }

        .controls {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .controls h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.2em;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.4);
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .slider-group label {
            font-weight: 500;
            color: #555;
            min-width: 100px;
        }

        .slider {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .code-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid #28a745;
        }

        .code-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.5;
        }

        .highlight {
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            color: #667eea;
        }

        .feature-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 5px 5px 5px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .slider-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .slider-group label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåä Custom Color Mapping Velocity Visualization</h1>
        <p>Professional windy.com-style weather visualization with your own custom color schemes</p>
    </div>

    <div class="container">
        <div class="info-box">
            <h3>üéØ What You're Seeing</h3>
            <p>This example demonstrates the <span class="highlight">Custom Color Mapping</span> feature that combines:</p>
            <br>
            <div class="feature-badge">Simple Color Arrays</div>
            <div class="feature-badge">Custom Color Schemes</div>
            <div class="feature-badge">Colored Particles</div>
            <div class="feature-badge">Smooth Gradients</div>
            <div class="feature-badge">Real-time Animation</div>
            <br><br>
            <p>You can now specify custom colors as a simple array! The colors map evenly across your velocity range, creating a beautiful dynamic visualization exactly like windy.com but with your own color scheme!</p>
        </div>

        <div class="controls">
            <h3>üéÆ Interactive Controls</h3>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="toggleOverlay()">Toggle Color Overlay</button>
                <button class="btn btn-primary" onclick="toggleParticles()">Toggle Particles</button>
                <button class="btn btn-success" onclick="enableColorParticles()">üåà Enable Color Particles</button>
                <button class="btn btn-warning" onclick="enableBlackParticles()">‚ö´ Enable Black Particles</button>
            </div>

            <div class="button-group">
                <button class="btn btn-success" onclick="useWeatherColors()">üå¶Ô∏è Weather Colors</button>
                <button class="btn btn-success" onclick="useRainbowColors()">üåà Rainbow Colors</button>
                <button class="btn btn-success" onclick="useBlueColors()">üíô Blue Scale</button>
                <button class="btn btn-success" onclick="useDefaultColors()">üîÑ Default Colors</button>
            </div>

            <div class="slider-group">
                <label>Overlay Opacity:</label>
                <input type="range" class="slider" min="0" max="1" step="0.1" value="0.6" 
                       onchange="setOverlayOpacity(this.value)">
                <span id="opacityValue">0.6</span>
            </div>

            <div class="slider-group">
                <label>Particle Count:</label>
                <input type="range" class="slider" min="1000" max="8000" step="500" value="4000" 
                       onchange="setParticleCount(this.value)">
                <span id="particleValue">4000</span>
            </div>
        </div>

        <div class="map-container">
            <div id="map"></div>
        </div>

        <div class="code-section">
            <h3>üíª Implementation Code</h3>
            <p>Here's exactly how to implement the <strong>Color Particles</strong> feature in your webpage:</p>

            <h4 style="margin: 20px 0 10px 0;">1. HTML Setup</h4>
            <pre><code>&lt;!-- Include Leaflet --&gt;
&lt;link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" /&gt;
&lt;script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"&gt;&lt;/script&gt;

&lt;!-- Include Velocity Plugin --&gt;
&lt;link rel="stylesheet" href="dist/leaflet-velocity.css" /&gt;
&lt;script src="dist/leaflet-velocity.js"&gt;&lt;/script&gt;

&lt;div id="map" style="height: 500px;"&gt;&lt;/div&gt;</code></pre>

            <h4 style="margin: 20px 0 10px 0;">2. JavaScript Implementation</h4>
            <pre><code>// Initialize map
const map = L.map('map').setView([37.7749, -122.4194], 6);

// Add base layer
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

// Define your custom knot-based color mapping
const knotColorData = [
  { "knots": 0,  "color": "#9700ff" },  // Purple for calm
  { "knots": 2,  "color": "#6400ff" },
  { "knots": 4,  "color": "#3200ff" },
  { "knots": 6,  "color": "#0032ff" },  // Blue for light wind
  { "knots": 8,  "color": "#0064ff" },
  { "knots": 10, "color": "#0096ff" },
  { "knots": 12, "color": "#00c7ff" },
  { "knots": 14, "color": "#00e6f0" },  // Cyan for moderate wind
  { "knots": 16, "color": "#25c192" },
  { "knots": 18, "color": "#11d411" },
  { "knots": 20, "color": "#00e600" },  // Green for fresh wind
  { "knots": 22, "color": "#00fa00" },
  { "knots": 24, "color": "#b8ff61" },
  { "knots": 26, "color": "#fffe00" },  // Yellow for strong wind
  { "knots": 28, "color": "#ffe100" },
  { "knots": 30, "color": "#ffc800" },
  { "knots": 32, "color": "#ffaf00" },  // Orange for very strong
  { "knots": 34, "color": "#ff9600" },
  { "knots": 36, "color": "#e67d00" },
  { "knots": 38, "color": "#e66400" },
  { "knots": 40, "color": "#dc4a1d" },  // Red for gale force
  { "knots": 42, "color": "#c8321d" },
  { "knots": 44, "color": "#b4191d" },
  { "knots": 46, "color": "#aa001d" },
  { "knots": 48, "color": "#b40032" },  // Deep red for storm
  { "knots": 50, "color": "#c80064" },
  { "knots": 51, "color": "#fe0096" }   // Pink for hurricane
];

// Load velocity data
fetch('demo/wind-gbr.json')
  .then(response => response.json())
  .then(data => {
    // Create velocity layer with CUSTOM COLOR PARTICLES
    const velocityLayer = L.velocityLayer({
      // üåà CUSTOM COLOR PARTICLES CONFIGURATION
      showColorOverlay: true,      // Enable color overlay
      overlayOpacity: 0.6,         // Semi-transparent overlay
      overlaySmoothing: 'high',    // Smooth gradients
      
      // üéØ YOUR CUSTOM COLOR MAPPING
      customColorMap: knotColorData,  // Use your knot-based colors!
      
      // Particle settings
      particleColor: 'velocity',   // Color particles by velocity
      particleCount: 4000,         // Plenty of particles
      particleLife: 40,            // Smooth animation
      frameRate: 15,               // Smooth performance
      
      // Data configuration
      data: data,
      velocityScale: 0.005
    });

    // Add to map
    velocityLayer.addTo(map);
    
    // üéÆ Control Methods
    window.velocityLayer = velocityLayer; // Make globally accessible
  });</code></pre>

            <h4 style="margin: 20px 0 10px 0;">3. Interactive Controls</h4>
            <pre><code>// Toggle features
function toggleOverlay() {
  velocityLayer.toggleColorOverlay();
}

function toggleParticles() {
  velocityLayer.toggleParticles();
}

// Enable color particles (the feature you want!)
function enableColorParticles() {
  velocityLayer.setOptions({
    showColorOverlay: true,
    particleColor: 'velocity'  // üåà Colored particles
  });
}

// Enable black particles
function enableBlackParticles() {
  velocityLayer.setOptions({
    showColorOverlay: true,
    particleColor: '#000000'   // ‚ö´ Black particles
  });
}

// Adjust opacity
function setOverlayOpacity(value) {
  velocityLayer.setOverlayOpacity(parseFloat(value));
}</code></pre>

            <h4 style="margin: 20px 0 10px 0;">4. Key Configuration Options</h4>
            <pre><code>const velocityOptions = {
  // üåà COLOR PARTICLES SETUP
  showColorOverlay: true,        // Show color gradient
  overlayOpacity: 0.6,          // Transparency (0-1)
  overlaySmoothing: 'high',     // Quality: 'low', 'medium', 'high', 'ultra'
  
  // üéØ CUSTOM COLOR MAPPING (SIMPLIFIED!)
  customColorMap: [             // Just an array of colors!
    "#9700ff",  // Purple for low velocity
    "#0032ff",  // Blue for light velocity
    "#00c7ff",  // Cyan for moderate velocity
    "#11d411",  // Green for fresh velocity
    "#fffe00",  // Yellow for strong velocity
    "#ff9600",  // Orange for very strong velocity
    "#dc4a1d",  // Red for extreme velocity
    "#fe0096"   // Pink for hurricane-force velocity
  ],
  
  // üé® PARTICLE COLORING
  particleColor: 'velocity',    // Color by velocity (uses custom colors)
  // OR use fixed color: particleColor: '#ffffff'
  
  // üìä PERFORMANCE
  particleCount: 4000,          // Number of particles
  particleLife: 40,             // Animation smoothness
  frameRate: 15,                // FPS balance
  
  // üé® VELOCITY RANGE
  minVelocity: 0,              // Min velocity in m/s
  maxVelocity: 25,             // Max velocity in m/s (‚âà50 knots)
  velocityScale: 0.005         // Animation speed
};</code></pre>

            <h4 style="margin: 20px 0 10px 0;">5. Custom Color Mapping Examples</h4>
            <pre><code>// Example 1: Weather-based colors (your original scheme)
const weatherColors = [
  "#9700ff", "#6400ff", "#3200ff", "#0032ff", "#0064ff", 
  "#0096ff", "#00c7ff", "#00e6f0", "#25c192", "#11d411", 
  "#00e600", "#00fa00", "#b8ff61", "#fffe00", "#ffe100", 
  "#ffc800", "#ffaf00", "#ff9600", "#e67d00", "#e66400", 
  "#dc4a1d", "#c8321d", "#b4191d", "#aa001d", "#b40032", 
  "#c80064", "#fe0096"
];

// Example 2: Simple rainbow colors
const rainbowColors = [
  "#8b00ff",  // Violet
  "#0000ff",  // Blue
  "#00ffff",  // Cyan
  "#00ff00",  // Green
  "#ffff00",  // Yellow
  "#ff8000",  // Orange
  "#ff0000"   // Red
];

// Example 3: Monochrome blue scale
const blueScale = [
  "#f0f8ff",  // Alice blue
  "#87ceeb",  // Sky blue
  "#4169e1",  // Royal blue
  "#00008b",  // Navy blue
  "#191970"   // Midnight blue
];

// Example 4: Ocean theme
const oceanTheme = [
  "#e6f3ff", "#b3d9ff", "#80bfff", "#4da6ff", 
  "#1a8cff", "#0073e6", "#005cb3", "#004080"
];

// Usage in velocity layer
const velocityLayer = L.velocityLayer({
  showColorOverlay: true,
  customColorMap: weatherColors,  // Use any of the above
  particleColor: 'velocity',
  minVelocity: 0,                 // Adjust velocity range as needed
  maxVelocity: 25                 // Higher values for more wind range
});</code></pre>
        </div>

        <div class="info-box">
            <h3>üöÄ Ready for Production</h3>
            <p>This implementation is production-ready and includes:</p>
            <ul style="margin-top: 10px; padding-left: 20px;">
                <li>‚úÖ <strong>Custom Color Mapping</strong> - Define exact colors for specific wind speeds in knots</li>
                <li>‚úÖ <strong>Color Particles</strong> - Particles colored by velocity intensity using your custom scheme</li>
                <li>‚úÖ <strong>Smooth Gradients</strong> - Professional windy.com-style overlays</li>
                <li>‚úÖ <strong>Multiple Color Schemes</strong> - Weather, rainbow, monochrome, or custom colors</li>
                <li>‚úÖ <strong>Performance Optimized</strong> - Smooth 60fps animation</li>
                <li>‚úÖ <strong>Cross-browser Compatible</strong> - Works in all modern browsers</li>
                <li>‚úÖ <strong>Mobile Responsive</strong> - Touch-friendly controls</li>
                <li>‚úÖ <strong>Easy Integration</strong> - Drop into any Leaflet project</li>
            </ul>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Velocity Plugin JavaScript -->
    <script src="dist/leaflet-velocity.js"></script>

    <script>
        let map, velocityLayer;

        // Initialize the map
        function initMap() {
            map = L.map('map').setView([25.0, 135.0], 4);

            // Add base tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);        // Load velocity data
        fetch('demo/wind-gbr.json')
            .then(response => response.json())
            .then(data => {
                // Define your custom color mapping (just the colors, no knots needed)
                const customColors = [
                    "#9700ff", "#6400ff", "#3200ff", "#0032ff", "#0064ff", 
                    "#0096ff", "#00c7ff", "#00e6f0", "#25c192", "#11d411", 
                    "#00e600", "#00fa00", "#b8ff61", "#fffe00", "#ffe100", 
                    "#ffc800", "#ffaf00", "#ff9600", "#e67d00", "#e66400", 
                    "#dc4a1d", "#c8321d", "#b4191d", "#aa001d", "#b40032", 
                    "#c80064", "#fe0096"
                ];

                // Create velocity layer with CUSTOM COLOR PARTICLES
                velocityLayer = L.velocityLayer({
                    // üåà CUSTOM COLOR PARTICLES CONFIGURATION
                    showColorOverlay: true,      // Enable color overlay
                    overlayOpacity: 0.6,         // Semi-transparent overlay
                    overlaySmoothing: 'high',    // Smooth gradients
                    
                    // üéØ YOUR CUSTOM COLOR MAPPING (SIMPLIFIED!)
                    customColorMap: customColors,    // Just an array of colors!
                    
                    // Particle settings for color particles
                    particleColor: 'velocity',   // Color particles by velocity
                    particleCount: 4000,         // Plenty of particles
                    particleLife: 40,            // Smooth animation
                    frameRate: 15,               // Smooth performance
                    
                    // Display options
                    displayOptions: {
                        velocityType: 'Global Wind',
                        displayPosition: 'bottomleft',
                        displayEmptyString: 'No wind data',
                        showCardinal: true
                    },
                    
                    // Data configuration
                    data: data,
                    minVelocity: 0,              // Min velocity in m/s
                    maxVelocity: 25,             // Max velocity in m/s (‚âà50 knots)
                    velocityScale: 0.005
                });

                // Add to map
                velocityLayer.addTo(map);
                
                console.log('üåà Custom Color Particles Velocity Layer loaded with your color scheme!');
            })
            .catch(error => {
                console.error('Error loading velocity data:', error);
            });
        }

        // Control functions
        function toggleOverlay() {
            if (velocityLayer) {
                velocityLayer.toggleColorOverlay();
            }
        }

        function toggleParticles() {
            if (velocityLayer) {
                velocityLayer.toggleParticles();
            }
        }

        function enableColorParticles() {
            if (velocityLayer) {
                velocityLayer.setOptions({
                    showColorOverlay: true,
                    particleColor: 'velocity'  // üåà Colored particles
                });
                console.log('üåà Color Particles enabled!');
            }
        }

        function enableBlackParticles() {
            if (velocityLayer) {
                velocityLayer.setOptions({
                    showColorOverlay: true,
                    particleColor: '#000000'   // ‚ö´ Black particles
                });
                console.log('‚ö´ Black Particles enabled!');
            }
        }

        function setOverlayOpacity(value) {
            if (velocityLayer) {
                velocityLayer.setOverlayOpacity(parseFloat(value));
                document.getElementById('opacityValue').textContent = value;
            }
        }

        function setParticleCount(value) {
            if (velocityLayer) {
                velocityLayer.setOptions({
                    particleCount: parseInt(value)
                });
                document.getElementById('particleValue').textContent = value;
            }
        }

        // Color scheme functions
        function useWeatherColors() {
            if (velocityLayer) {
                const weatherColors = [
                    "#9700ff", "#6400ff", "#3200ff", "#0032ff", "#0064ff", 
                    "#0096ff", "#00c7ff", "#00e6f0", "#25c192", "#11d411", 
                    "#00e600", "#00fa00", "#b8ff61", "#fffe00", "#ffe100", 
                    "#ffc800", "#ffaf00", "#ff9600", "#e67d00", "#e66400", 
                    "#dc4a1d", "#c8321d", "#b4191d", "#aa001d", "#b40032", 
                    "#c80064", "#fe0096"
                ];
                
                velocityLayer.setOptions({
                    customColorMap: weatherColors,
                    showColorOverlay: true,
                    minVelocity: 0,
                    maxVelocity: 25  // ‚âà50 knots
                });
                console.log('üå¶Ô∏è Weather Colors applied!');
            }
        }

        function useRainbowColors() {
            if (velocityLayer) {
                const rainbowColors = [
                    "#8b00ff", "#0000ff", "#00ffff", "#00ff00", 
                    "#ffff00", "#ff8000", "#ff0000"
                ];
                
                velocityLayer.setOptions({
                    customColorMap: rainbowColors,
                    showColorOverlay: true,
                    minVelocity: 0,
                    maxVelocity: 15  // ‚âà30 knots
                });
                console.log('üåà Rainbow Colors applied!');
            }
        }

        function useBlueColors() {
            if (velocityLayer) {
                const blueColors = [
                    "#f0f8ff", "#87ceeb", "#4169e1", "#00008b", "#191970"
                ];
                
                velocityLayer.setOptions({
                    customColorMap: blueColors,
                    showColorOverlay: true,
                    minVelocity: 0,
                    maxVelocity: 20  // ‚âà40 knots
                });
                console.log('üíô Blue Scale applied!');
            }
        }

        function useDefaultColors() {
            if (velocityLayer) {
                velocityLayer.setOptions({
                    customColorMap: null,  // Clear custom colors
                    showColorOverlay: true,
                    minVelocity: 0,
                    maxVelocity: 10        // Default range
                });
                console.log('üîÑ Default Colors restored!');
            }
        }

        // Initialize map when page loads
        document.addEventListener('DOMContentLoaded', initMap);
    </script>
</body>
</html>
