"use strict";L.DomUtil.setTransform||(L.DomUtil.setTransform=function(t,e,a){var o=e||new L.Point(0,0);t.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(a?" scale("+a+")":"")}),L.CanvasLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(t){this._map=null,this._canvas=null,this._frame=null,this._delegate=null,L.setOptions(this,t)},delegate:function(t){return this._delegate=t,this},needRedraw:function(){return this._frame||(this._frame=L.Util.requestAnimFrame(this.drawLayer,this)),this},_onLayerDidResize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},_onLayerDidMove:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),this.drawLayer()},getEvents:function(){var t={resize:this._onLayerDidResize,moveend:this._onLayerDidMove};return this._map.options.zoomAnimation&&L.Browser.any3d&&(t.zoomanim=this._animateZoom),t},onAdd:function(t){this._map=t,this._canvas=L.DomUtil.create("canvas","leaflet-layer"),this.tiles={};var e=this._map.getSize();this._canvas.width=e.x,this._canvas.height=e.y;var a=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(a?"animated":"hide")),this.options.pane.appendChild(this._canvas),t.on(this.getEvents(),this);var o=this._delegate||this;o.onLayerDidMount&&o.onLayerDidMount(),this.needRedraw();var n=this;setTimeout(function(){n._onLayerDidMove()},0)},onRemove:function(t){var e=this._delegate||this;e.onLayerWillUnmount&&e.onLayerWillUnmount(),this.options.pane.removeChild(this._canvas),t.off(this.getEvents(),this),this._canvas=null},addTo:function(t){return t.addLayer(this),this},drawLayer:function(){var t=this._map.getSize(),e=this._map.getBounds(),a=this._map.getZoom(),o=this._map.options.crs.project(this._map.getCenter()),n=this._map.options.crs.project(this._map.containerPointToLatLng(this._map.getSize())),i=this._delegate||this;i.onDrawLayer&&i.onDrawLayer({layer:this,canvas:this._canvas,bounds:e,size:t,zoom:a,center:o,corner:n}),this._frame=null},_setTransform:function(t,e,a){var o=e||new L.Point(0,0);t.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(a?" scale("+a+")":"")},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),a=L.Layer?this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),t.zoom,t.center):this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform(this._canvas,a,e)}}),L.canvasLayer=function(t){return new L.CanvasLayer(t)},L.Control.Velocity=L.Control.extend({options:{position:"bottomleft",emptyString:"Unavailable",angleConvention:"bearingCCW",showCardinal:!1,speedUnit:"m/s",directionString:"Direction",speedString:"Speed",onAdd:null,onRemove:null},onAdd:function(t){return this._container=L.DomUtil.create("div","leaflet-control-velocity"),L.DomEvent.disableClickPropagation(this._container),t.on("mousemove",this._onMouseMove,this),this._container.innerHTML=this.options.emptyString,this.options.leafletVelocity.options.onAdd&&this.options.leafletVelocity.options.onAdd(),this._container},onRemove:function(t){t.off("mousemove",this._onMouseMove,this),this.options.leafletVelocity.options.onRemove&&this.options.leafletVelocity.options.onRemove()},vectorToSpeed:function(t,e,a){var o=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return"k/h"===a?this.meterSec2kilometerHour(o):"kt"===a?this.meterSec2Knots(o):"mph"===a?this.meterSec2milesHour(o):o},vectorToDegrees:function(t,e,a){a.endsWith("CCW")&&(e=0<e?e=-e:Math.abs(e));var o=Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),n=180*Math.atan2(t/o,e/o)/Math.PI+180;return"bearingCW"!==a&&"meteoCCW"!==a||360<=(n+=180)&&(n-=360),n},degreesToCardinalDirection:function(t){var e="";return 0<=t&&t<11.25||348.75<=t?e="N":11.25<=t&&t<33.75?e="NNW":33.75<=t&&t<56.25?e="NW":56.25<=t&&t<78.75?e="WNW":78.25<=t&&t<101.25?e="W":101.25<=t&&t<123.75?e="WSW":123.75<=t&&t<146.25?e="SW":146.25<=t&&t<168.75?e="SSW":168.75<=t&&t<191.25?e="S":191.25<=t&&t<213.75?e="SSE":213.75<=t&&t<236.25?e="SE":236.25<=t&&t<258.75?e="ESE":258.75<=t&&t<281.25?e="E":281.25<=t&&t<303.75?e="ENE":303.75<=t&&t<326.25?e="NE":326.25<=t&&t<348.75&&(e="NNE"),e},meterSec2Knots:function(t){return t/.514},meterSec2kilometerHour:function(t){return 3.6*t},meterSec2milesHour:function(t){return 2.23694*t},_onMouseMove:function(t){var e=this.options.leafletVelocity._map.containerPointToLatLng(L.point(t.containerPoint.x,t.containerPoint.y)),a=this.options.leafletVelocity._windy.interpolatePoint(e.lng,e.lat),o="";if(a&&!isNaN(a[0])&&!isNaN(a[1])&&a[2]){var n=this.vectorToDegrees(a[0],a[1],this.options.angleConvention),i=this.options.showCardinal?" (".concat(this.degreesToCardinalDirection(n),") "):"";o="<strong> ".concat(this.options.velocityType," ").concat(this.options.directionString,": </strong> ").concat(n.toFixed(2),"Â°").concat(i,", <strong> ").concat(this.options.velocityType," ").concat(this.options.speedString,": </strong> ").concat(this.vectorToSpeed(a[0],a[1],this.options.speedUnit).toFixed(2)," ").concat(this.options.speedUnit)}else o=this.options.emptyString;this._container.innerHTML=o}}),L.Map.mergeOptions({positionControl:!1}),L.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new L.Control.MousePosition,this.addControl(this.positionControl))}),L.control.velocity=function(t){return new L.Control.Velocity(t)},L.VelocityLayer=(L.Layer?L.Layer:L.Class).extend({options:{displayValues:!0,displayOptions:{velocityType:"Velocity",position:"bottomleft",emptyString:"No velocity data"},maxVelocity:10,colorScale:null,customColorMap:null,data:null,showColorOverlay:!1,overlayOpacity:.5,overlaySmoothing:"high"},_map:null,_canvasLayer:null,_overlayCanvasLayer:null,_windy:null,_context:null,_overlayContext:null,_timer:0,_mouseControl:null,initialize:function(t){L.setOptions(this,t)},onAdd:function(t){this._paneName=this.options.paneName||"overlayPane";var e=t._panes.overlayPane;t.getPane&&(e=(e=t.getPane(this._paneName))||t.createPane(this._paneName));var a=e,o=e;if(this.options.showColorOverlay&&t.createPane){var n=this._paneName+"-overlay";(a=t.getPane(n))||((a=t.createPane(n)).style.zIndex=200);var i=this._paneName+"-particles";(o=t.getPane(i))||((o=t.createPane(i)).style.zIndex=210)}this.options.showColorOverlay&&this._createOverlayLayer(a),this._canvasLayer=L.canvasLayer({pane:o}).delegate(this),this._canvasLayer.addTo(t),this._map=t},_createOverlayLayer:function(t){if(!this._overlayCanvasLayer){this._overlayCanvasLayer=L.canvasLayer({pane:t}).delegate(this),this._overlayCanvasLayer.addTo(this._map);var e=this;setTimeout(function(){void 0!==e.options.overlayOpacity&&e._overlayCanvasLayer&&e._overlayCanvasLayer._canvas&&(e._overlayCanvasLayer._canvas.style.opacity=e.options.overlayOpacity)},0)}},onRemove:function(t){this._destroyWind()},setData:function(t){this.options.data=t,this._windy&&(this._windy.setData(t),this._clearAndRestart()),this.fire("load")},setOpacity:function(t){this._canvasLayer.setOpacity(t),this._overlayCanvasLayer&&this._overlayCanvasLayer._canvas&&(this._overlayCanvasLayer._canvas.style.opacity=this.options.overlayOpacity)},setOverlayOpacity:function(t){this.options.overlayOpacity=t,this._overlayCanvasLayer&&this._overlayCanvasLayer._canvas&&(this._overlayCanvasLayer._canvas.style.opacity=t)},setOverlaySmoothing:function(t){this.options.overlaySmoothing=t,this.options.showColorOverlay&&this._windy&&this._windy.field&&this._drawColorOverlay()},toggleColorOverlay:function(){this.setOptions({showColorOverlay:!this.options.showColorOverlay})},setOptions:function(t){if(this.options=Object.assign(this.options,t),t.hasOwnProperty("displayOptions")&&(this.options.displayOptions=Object.assign(this.options.displayOptions,t.displayOptions),this._initMouseHandler(!0)),t.hasOwnProperty("data")&&(this.options.data=t.data),this._windy&&(this._windy.setOptions(t),t.hasOwnProperty("data")&&this._windy.setData(t.data),this._clearAndRestart()),t.hasOwnProperty("overlayOpacity")&&this._overlayCanvasLayer&&this._overlayCanvasLayer._canvas&&(this._overlayCanvasLayer._canvas.style.opacity=this.options.overlayOpacity,this.options.showColorOverlay&&this._windy&&this._windy.field&&this._drawColorOverlay()),t.hasOwnProperty("showColorOverlay"))if(this.options.showColorOverlay){if(!this._overlayCanvasLayer){var e=this._map._panes.overlayPane;if(this._map.getPane&&this._map.createPane){var a=(this._paneName||"overlayPane")+"-overlay";(e=this._map.getPane(a))||((e=this._map.createPane(a)).style.zIndex=200)}this._createOverlayLayer(e)}this._windy&&this._windy.field&&this._drawColorOverlay()}else this._overlayContext&&this._overlayCanvasLayer&&this._overlayCanvasLayer._canvas&&this._overlayContext.clearRect(0,0,this._overlayCanvasLayer._canvas.width,this._overlayCanvasLayer._canvas.height);this.fire("load")},onDrawLayer:function(t,e){var a=this;this._windy?this.options.data&&(this._timer&&clearTimeout(a._timer),this._timer=setTimeout(function(){a._startWindy()},750)):this._initWindy(this)},_startWindy:function(){var t=this._map.getBounds(),e=this._map.getSize();this._windy.start([[0,0],[e.x,e.y]],e.x,e.y,[[t._southWest.lng,t._southWest.lat],[t._northEast.lng,t._northEast.lat]])},_initWindy:function(t){if(t._canvasLayer&&t._canvasLayer._canvas){var e=Object.assign({canvas:t._canvasLayer._canvas,map:this._map,onFieldReady:function(){t.options.showColorOverlay&&t._overlayContext&&t._drawColorOverlay()}},t.options);this._windy=new Windy(e),this._context=this._canvasLayer._canvas.getContext("2d"),this._canvasLayer._canvas.classList.add("velocity-overlay"),this.options.showColorOverlay&&this._overlayCanvasLayer&&this._overlayCanvasLayer._canvas&&(this._overlayContext=this._overlayCanvasLayer._canvas.getContext("2d"),this._overlayCanvasLayer._canvas.classList.add("color-overlay")),this.onDrawLayer(),this._map.on("dragstart",t._windy.stop),this._map.on("dragend",t._clearAndRestart),this._map.on("zoomstart",t._windy.stop),this._map.on("zoomend",t._clearAndRestart),this._map.on("resize",t._clearWind),this._initMouseHandler(!1)}else console.error("Canvas layer not properly initialized")},_initMouseHandler:function(t){if(t&&(this._map.removeControl(this._mouseControl),this._mouseControl=!1),!this._mouseControl&&this.options.displayValues){var e=this.options.displayOptions||{};(e.leafletVelocity=this)._mouseControl=L.control.velocity(e).addTo(this._map)}},_clearAndRestart:function(){this._context&&this._context.clearRect(0,0,3e3,3e3),this._overlayContext&&this._overlayContext.clearRect(0,0,3e3,3e3),this._windy&&this._startWindy()},_clearWind:function(){this._windy&&this._windy.stop(),this._context&&this._context.clearRect(0,0,3e3,3e3),this._overlayContext&&this._overlayContext.clearRect(0,0,3e3,3e3)},_drawColorOverlay:function(){if(this._overlayContext&&this._windy&&this._windy.field){var t=this._overlayCanvasLayer._canvas;if(t){var e=t.width,a=t.height;this._overlayContext.clearRect(0,0,e,a);try{var o;this.options.customColorMap&&Array.isArray(this.options.customColorMap)?(o=this.options.customColorMap,console.log("Using custom color map:",{colors:o.slice(0,3),totalColors:o.length})):o=this.options.colorScale||["rgb(36,104, 180)","rgb(60,157, 194)","rgb(128,205,193)","rgb(151,218,168)","rgb(198,231,181)","rgb(238,247,217)","rgb(255,238,159)","rgb(252,217,125)","rgb(255,182,100)","rgb(252,150,75)","rgb(250,112,52)","rgb(245,64,32)","rgb(237,45,28)","rgb(220,24,32)","rgb(180,0,35)"];var n=o.map(function(t){if(t.startsWith&&t.startsWith("#")){var e=t.slice(1);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}var a=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return a?[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]:[0,0,0]});console.log("Color scale debug:",{originalColors:o.slice(0,3),parsedColors:n.slice(0,3),totalColors:n.length});var i,r,s=this.options.minVelocity||0,l=this.options.maxVelocity||10,h=this._windy.field;switch(console.log("Alpha and velocity range:",{minVelocity:s,maxVelocity:l,alpha:255,overlayOpacity:this.options.overlayOpacity}),this.options.overlaySmoothing||"high"){case"low":i=32,r=0;break;case"medium":i=24,r=.5;break;case"high":i=16,r=1;break;case"ultra":i=12,r=1.5;break;default:i=16,r=1}for(var c=[],y={sampleCount:0,velocitySum:0,maxFound:0,minFound:1/0,normalizedSamples:[]},v=0;v<a;v+=i){c[v]=c[v]||[];for(var d=0;d<e;d+=i)try{var p=h(d,v);if(p&&3<=p.length&&null!==p[2]&&!isNaN(p[2])){var u=p[2],m=Math.max(0,Math.min(1,(u-s)/(l-s)));c[v][d]=m,y.sampleCount++,y.velocitySum+=u,y.maxFound=Math.max(y.maxFound,u),y.minFound=Math.min(y.minFound,u),y.normalizedSamples.length<10&&y.normalizedSamples.push({raw:u,normalized:m,position:[d,v]})}else c[v][d]=0}catch(t){c[v][d]=0}}console.log("Velocity Debug Info:",{sampleCount:y.sampleCount,avgVelocity:0<y.sampleCount?y.velocitySum/y.sampleCount:0,minVelocity:s,maxVelocity:l,actualMin:y.minFound,actualMax:y.maxFound,colorCount:n.length,normalizedSamples:y.normalizedSamples}),this._drawSmoothGradient(c,i,e,a,n,255,r),console.log("Smooth color overlay drawn successfully")}catch(t){console.error("Error drawing color overlay:",t)}}else console.log("Overlay canvas not available")}else console.log("Color overlay not ready:",{context:!!this._overlayContext,windy:!!this._windy,field:!(!this._windy||!this._windy.field)})},_drawSmoothGradient:function(t,e,a,o,s,l,n){var i,r,h,c,y,v,d=this._overlayContext.createImageData(a,o),p=d.data;function u(t){if(t<=0)return[0,0,0,0];var e=Math.min(s.length-1,Math.floor(t*s.length)),a=Math.min(s.length-1,e+1),o=t*s.length-e,n=s[e],i=s[a],r=[Math.round(n[0]+(i[0]-n[0])*o),Math.round(n[1]+(i[1]-n[1])*o),Math.round(n[2]+(i[2]-n[2])*o),l];return Math.random()<.001&&console.log("Color mapping:",{normalizedMagnitude:t,colorIndex:e,color:r,rgb1:n,rgb2:i}),r}for(var m=0;m<o;m++)for(var _=0;_<a;_++){var f=4*(m*a+_),g=Math.floor(_/e)*e,L=Math.floor(m/e)*e,w=Math.min(g+e,a-1),C=Math.min(L+e,o-1),x=t[L]&&void 0!==t[L][g]?t[L][g]:0,M=t[C]&&void 0!==t[C][g]?t[C][g]:0,O=t[L]&&void 0!==t[L][w]?t[L][w]:0,b=t[C]&&void 0!==t[C][w]?t[C][w]:0,S=u(g===w&&L===C?x:g===w?x+(m-L)/(C-L)*(M-x):L===C?x+(_-g)/(w-g)*(O-x):((v=C)-(r=m))/(v-(c=L))*(((y=w)-(i=_))/(y-(h=g))*x+(i-h)/(y-h)*O)+(r-c)/(v-c)*((y-i)/(y-h)*M+(i-h)/(y-h)*b));f<p.length-3&&(p[f]=S[0],p[1+f]=S[1],p[2+f]=S[2],p[3+f]=S[3])}this._overlayContext.putImageData(d,0,0),0<n&&(this._overlayContext.filter="blur("+n+"px)",this._overlayContext.globalCompositeOperation="source-over",this._overlayContext.drawImage(this._overlayCanvasLayer._canvas,0,0),this._overlayContext.filter="none")},_destroyWind:function(){this._timer&&clearTimeout(this._timer),this._windy&&this._windy.stop(),this._context&&this._context.clearRect(0,0,3e3,3e3),this._overlayContext&&this._overlayContext.clearRect(0,0,3e3,3e3),this._mouseControl&&this._map.removeControl(this._mouseControl),this._mouseControl=null,this._windy=null,this._canvasLayer&&this._map.removeLayer(this._canvasLayer),this._overlayCanvasLayer&&this._map.removeLayer(this._overlayCanvasLayer)}}),L.velocityLayer=function(t){return new L.VelocityLayer(t)};var Windy=function(b){function n(t,e,a,o,n,i){var r=1-t,s=1-e,l=r*s,h=t*s,c=r*e,y=t*e,v=a[0]*l+o[0]*h+n[0]*c+i[0]*y,d=a[1]*l+o[1]*h+n[1]*c+i[1]*y;return[v,d,Math.sqrt(v*v+d*d)]}function y(t){var e=null,a=null;return t.forEach(function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":e=t;break;case"1,3":case"2,3":a=t;break;default:t}}),function(t,e){var a=t.data,o=e.data;return{header:t.header,data:function(t){return[a[t],o[t]]},interpolate:n}}(e,a)}function i(o,n,t){function i(t,e){var a=o[Math.round(t)];return a&&a[Math.round(e)]||h}i.release=function(){o=[]},i.randomize=function(t){for(var e,a,o=0;null===i(e=Math.round(Math.floor(Math.random()*n.width)+n.x),a=Math.round(Math.floor(Math.random()*n.height)+n.y))[2]&&o++<30;);return t.x=e,t.y=a,t},t(n,i)}function r(t){return t/180*Math.PI}function s(o,s){var e,a,l=(e=x,a=M,R.indexFor=function(t){return Math.max(0,Math.min(R.length-1,Math.round((t-e)/(a-e)*(R.length-1))))},R),h=l.map(function(){return[]}),t=Math.round(o.width*o.height*P);/android|blackberry|iemobile|ipad|iphone|ipod|opera mini|webos/i.test(navigator.userAgent)&&(t*=D);for(var n="rgba(0, 0, 0, ".concat(W,")"),i=[],r=0;r<t;r++)i.push(s.randomize({age:Math.floor(Math.random()*O)+0}));var c=b.canvas.getContext("2d");c.lineWidth=S,c.fillStyle=n,c.globalAlpha=.6;var y=Date.now();!function t(){C=requestAnimationFrame(t);var e=Date.now(),a=e-y;T<a&&(y=e-a%T,h.forEach(function(t){t.length=0}),i.forEach(function(t){t.age>O&&(s.randomize(t).age=0);var e=t.x,a=t.y,o=s(e,a),n=o[2];if(null===n)t.age=O;else{var i=e+o[0],r=a+o[1];null!==s(i,r)[2]?(t.xt=i,t.yt=r,h[l.indexFor(n)].push(t)):(t.x=i,t.y=r)}t.age+=1}),c.globalCompositeOperation="destination-in",c.fillRect(o.x,o.y,o.width,o.height),c.globalCompositeOperation="lighter",c.globalAlpha=0===W?0:.9*W,h.forEach(function(t,e){0<t.length&&(c.beginPath(),c.strokeStyle=l[e],t.forEach(function(t){c.moveTo(t.x,t.y),c.lineTo(t.xt,t.yt),t.x=t.xt,t.y=t.yt}),c.stroke())}))}()}var d,p,v,u,m,_,f,g,w,C,x=b.minVelocity||0,M=b.maxVelocity||10,l=(b.velocityScale||.005)*(Math.pow(window.devicePixelRatio,1/3)||1),O=b.particleAge||90,S=b.lineWidth||1,P=b.particleMultiplier||1/300,D=Math.pow(window.devicePixelRatio,1/3)||1.6,e=b.frameRate||15,T=1e3/e,W=.97,R=b.colorScale||["rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)"],h=[NaN,NaN,null],c=b.data,z=function(t,e){if(!p)return null;var a,o=A(t-u,360)/_,n=(m-e)/f,i=Math.floor(o),r=i+1,s=Math.floor(n),l=s+1;if(a=p[s]){var h=a[i],c=a[r];if(N(h)&&N(c)&&(a=p[l])){var y=a[i],v=a[r];if(N(y)&&N(v))return d.interpolate(o-i,n-s,h,c,y,v)}}return null},N=function(t){return null!=t},A=function(t,e){return t-e*Math.floor(t/e)},V=function(t,e,a,o,n){var i=2*Math.PI,r=e<0?5:-5,s=a<0?5:-5,l=E(a,e+r),h=E(a+s,e),c=Math.cos(a/360*i);return[(l[0]-o)/r/c,(l[1]-n)/r/c,(h[0]-o)/s,(h[1]-n)/s]},E=function(t,e,a){var o=b.map.latLngToContainerPoint(L.latLng(t,e));return[o.x,o.y]},F=function(){I.field&&I.field.release(),C&&cancelAnimationFrame(C)},I={params:b,start:function(e,a,o,t){var n={south:r(t[0][1]),north:r(t[1][1]),east:r(t[1][0]),west:r(t[0][0]),width:a,height:o};F(),function(t,e){var a=!0;t.length<2&&(a=!1),a||console.log("Windy Error: data must have at least two components (u,v)");var o=(d=y(t)).header;if(o.hasOwnProperty("gridDefinitionTemplate")&&0!=o.gridDefinitionTemplate&&(a=!1),a||console.log("Windy Error: Only data with Latitude_Longitude coordinates is supported"),a=!0,u=o.lo1,m=o.la1,_=o.dx,f=o.dy,g=o.nx,w=o.ny,o.hasOwnProperty("scanMode")){var n=o.scanMode.toString(2),i=(n=("0"+n).slice(-8)).split("").map(Number).map(Boolean);i[0]&&(_=-_),i[1]&&(f=-f),i[2]&&(a=!1),i[3]&&(a=!1),i[4]&&(a=!1),i[5]&&(a=!1),i[6]&&(a=!1),i[7]&&(a=!1),a||console.log("Windy Error: Data with scanMode: "+o.scanMode+" is not supported.")}(v=new Date(o.refTime)).setHours(v.getHours()+o.forecastTime),p=[];for(var r=0,s=360<=Math.floor(g*_),l=0;l<w;l++){for(var h=[],c=0;c<g;c++,r++)h[c]=d.data(r);s&&h.push(h[0]),p[l]=h}e({date:v,interpolate:z})}(c,function(t){!function(w,C,t,a){var x={},e=(t.south-t.north)*(t.west-t.east),M=l*Math.pow(e,.4),O=[],o=C.x;function n(t){for(var e,a,o,n,i,r,s,l,h,c,y,v,d,p=[],u=C.y;u<=C.yMax;u+=2){var m=(y=t,v=u,void 0,[(d=b.map.containerPointToLatLng(L.point(y,v))).lng,d.lat]),_=m[0],f=m[1];if(isFinite(_)){var g=w.interpolate(_,f);g&&(e=x,a=_,o=f,n=t,i=u,r=M,void 0,l=(s=g)[0]*r,h=s[1]*r,c=V(e,a,o,n,i),s[0]=c[0]*l+c[2]*h,s[1]=c[1]*l+c[3]*h,g=s,p[u+1]=p[u]=g)}}O[t+1]=O[t]=p}!function t(){for(var e=Date.now();o<C.width;)if(n(o),o+=2,1e3<Date.now()-e)return void setTimeout(t,25);i(O,C,a)}()}(t,function(t,e,a){var o=t[0],n=t[1],i=Math.round(o[0]),r=Math.max(Math.floor(o[1],0),0);Math.min(Math.ceil(n[0],e),e-1);return{x:i,y:r,xMax:e,yMax:Math.min(Math.ceil(n[1],a),a-1),width:e,height:a}}(e,a,o),n,function(t,e){I.field=e,s(t,e),b.onFieldReady&&b.onFieldReady()})})},stop:F,createField:i,interpolatePoint:z,setData:function(t){c=t},setOptions:function(t){t.hasOwnProperty("minVelocity")&&(x=t.minVelocity),t.hasOwnProperty("maxVelocity")&&(M=t.maxVelocity),t.hasOwnProperty("velocityScale")&&(l=(t.velocityScale||.005)*(Math.pow(window.devicePixelRatio,1/3)||1)),t.hasOwnProperty("particleAge")&&(O=t.particleAge),t.hasOwnProperty("lineWidth")&&(S=t.lineWidth),t.hasOwnProperty("particleMultiplier")&&(P=t.particleMultiplier),t.hasOwnProperty("opacity")&&(W=+t.opacity),t.hasOwnProperty("frameRate")&&(e=t.frameRate),T=1e3/e}};return I};window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});